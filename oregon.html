---
layout: btc
title: oregon
permalink: /oregon/
---
<div class="container">
	<div class="row mods">
		<h1>Oregon State Summary</h1>
		<div class="col-md-6">
			<span class="h3">$295.4m</span>
			<span>Raised</span>
		</div>
		<div class="col-md-6">
			<span class="h3">$295.4m</span>
			<span>Spent</span>
		</div>
	</div>
	<div class="row">
		<div class="col-md-12">
			<h2>Who is giving?</h2>
			<div id="who-is-giving"></div>
			<script type="text/javascript">
		     	function drawBarChart() {
			     	var svg = dimple.newSvg("#who-is-giving", 590, 400);
				     d3.tsv("{{ site.baseurl }}/data/oregon-data.tsv", function (data) {
				      var myChart = new dimple.chart(svg, data);
				      myChart.setBounds(60, 30, 510, 305)
				      var x = myChart.addCategoryAxis("x", "Donor");
				      // x.addOrderRule("Date");
				      myChart.addMeasureAxis("y", "Amount");
				      myChart.addSeries(null, dimple.plot.bar);
				      myChart.draw();
				    });
		     	}
		     	drawBarChart();
		   </script>  
		</div>
	</div>

  <div class="row">
    <div class="col-md-12">
			<h3>How does the money flow?</h3>
	    <div id="sankey-chart">[ Sankey ]</div>
	    <script>
		  //   function moneyFlowChart() {
		  //   	var margin = {top: 1, right: 1, bottom: 6, left: 1},
			 //    width = 960 - margin.left - margin.right,
			 //    height = 500 - margin.top - margin.bottom;

				// var formatNumber = d3.format(",.0f"),
				//     format = function(d) { return formatNumber(d) + " TWh"; },
				//     color = d3.scale.category20();

				// var svg = d3.select("#sankey-chart").append("svg")
				//     .attr("width", width + margin.left + margin.right)
				//     .attr("height", height + margin.top + margin.bottom)
				//   .append("g")
				//     .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

				// var sankey = d3.sankey()
				//     .nodeWidth(15)
				//     .nodePadding(10)
				//     .size([width, height]);

				// var path = sankey.link();

				// d3.json("../data/sankey.json", function(energy) {

				//   sankey
				//       .nodes(energy.nodes)
				//       .links(energy.links)
				//       .layout(32);

				//   var link = svg.append("g").selectAll(".link")
				//       .data(energy.links)
				//     .enter().append("path")
				//       .attr("class", "link")
				//       .attr("d", path)
				//       .style("stroke-width", function(d) { return Math.max(1, d.dy); })
				//       .sort(function(a, b) { return b.dy - a.dy; });

				//   link.append("title")
				//       .text(function(d) { return d.source.name + " â†’ " + d.target.name + "\n" + format(d.value); });

				//   var node = svg.append("g").selectAll(".node")
				//       .data(energy.nodes)
				//     .enter().append("g")
				//       .attr("class", "node")
				//       .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; })
				//     .call(d3.behavior.drag()
				//       .origin(function(d) { return d; })
				//       .on("dragstart", function() { this.parentNode.appendChild(this); })
				//       .on("drag", dragmove));

				//   node.append("rect")
				//       .attr("height", function(d) { return d.dy; })
				//       .attr("width", sankey.nodeWidth())
				//       .style("fill", function(d) { return d.color = color(d.name.replace(/ .*/, "")); })
				//       .style("stroke", function(d) { return d3.rgb(d.color).darker(2); })
				//     .append("title")
				//       .text(function(d) { return d.name + "\n" + format(d.value); });

				//   node.append("text")
				//       .attr("x", -6)
				//       .attr("y", function(d) { return d.dy / 2; })
				//       .attr("dy", ".35em")
				//       .attr("text-anchor", "end")
				//       .attr("transform", null)
				//       .text(function(d) { return d.name; })
				//     .filter(function(d) { return d.x < width / 2; })
				//       .attr("x", 6 + sankey.nodeWidth())
				//       .attr("text-anchor", "start");

				//   function dragmove(d) {
				//     d3.select(this).attr("transform", "translate(" + d.x + "," + (d.y = Math.max(0, Math.min(height - d.dy, d3.event.y))) + ")");
				//     sankey.relayout();
				//     link.attr("d", path);
				//   }
				// });
	   //  }
	   //  moneyFlowChart();
	    </script>
    </div>
  </div>
	
	<div class="row">
		<div class="col-md-12">
			<h3>When are they raising and spending?</h3>
			<div id="raising-spending-chart"></div>
			<script type="text/javascript">
			function drawLineChart() {
		    var svg = dimple.newSvg("#raising-spending-chart", 590, 400);
		    d3.tsv("{{ site.baseurl }}/data/example_data.tsv", function (data) {
		      data = dimple.filterData(data, "Owner", ["Aperture", "Black Mesa"])
		      var myChart = new dimple.chart(svg, data);
		      myChart.setBounds(60, 30, 505, 305);
		      var x = myChart.addCategoryAxis("x", "Month");
		      x.addOrderRule("Date");
		      myChart.addMeasureAxis("y", "Unit Sales");
		      var s = myChart.addSeries("Channel", dimple.plot.line);
		      s.interpolation = "cardinal";
		      myChart.addLegend(60, 10, 500, 20, "right");
		      myChart.draw();
		    });
			}
			drawLineChart();
		  </script>
		</div>
	</div>

	<div class="row">
		<div class="col-md-12">
			<h3>Is the money local?</h3>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/queue-async/1.0.7/queue.min.js"></script>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js"></script>
			<script>
			function drawMap() {
				var width = 960,
			    height = 600;

			var rateById = d3.map();

			var quantize = d3.scale.quantize()
			    .domain([0, .15])
			    .range(d3.range(9).map(function(i) { return "q" + i + "-9"; }));

			var projection = d3.geo.albersUsa()
			    .scale(1280)
			    .translate([width / 2, height / 2]);

			var path = d3.geo.path()
			    .projection(projection);

			var svg = d3.select("money-map").append("svg")
			    .attr("width", width)
			    .attr("height", height);

			queue()
			    .defer(d3.json, "http://bl.ocks.org/mbostock/raw/4090846/us.json")
			    .defer(d3.tsv, "unemployment.tsv", function(d) { rateById.set(d.id, +d.rate); })
			    .await(ready);

			function ready(error, us) {
			  if (error) throw error;

			  svg.append("g")
			      .attr("class", "counties")
			    .selectAll("path")
			      .data(topojson.feature(us, us.objects.counties).features)
			    .enter().append("path")
			      .attr("class", function(d) { return quantize(rateById.get(d.id)); })
			      .attr("d", path);

			  svg.append("path")
			      .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
			      .attr("class", "states")
			      .attr("d", path);
			}

			d3.select(self.frameElement).style("height", height + "px");

			};
			// drawMap();

			</script>
			<div id="money-map">[ map ]</div>
		</div>
	</div>

</div>